---
title: "Grafici"
author: ""
subtitle: "" 
include-in-header: assets/header.html
format:
  html:
    theme: cosmo
    code-fold: false
    self-contained: true
    toc: true   
    toc-depth: 3 
    toc-expand: 3
    message: false
    css: "assets/custom.css"
execute:
  echo: false
  warning: false
  message: false
editor: visual
---

## Istogramma

```{=html}
<style>
.flex-container {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
}

.flex-item {
  flex: 1 1 48%;
  min-width: 300px;
}

.card {
  background-color: #f9f9f9;
  padding: 1rem;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
</style>

<div class="flex-container">
  <div class="flex-item card">
```

```{r}
hist(mtcars$mpg,
     main = "Istogramma del Consumo (MPG)",
     xlab = "MPG",
     col = "orange",
     border = "white")
```

::: tip
#### üß≠ Come si legge un istogramma? ‚Äì Guida schematica e utile

#### ‚úÖ 1. **Leggi gli assi**

-   **Asse X (orizzontale)**: rappresenta gli **intervalli dei valori** della variabile (es. consumo, et√†, punteggi).
-   **Asse Y (verticale)**: mostra la **frequenza** (quante osservazioni cadono in ciascun intervallo).

#### ‚úÖ 2. **Osserva la forma generale**

-   **Simmetrica** ‚Üí distribuzione equilibrata intorno alla media.
-   **Asimmetrica a destra** ‚Üí pochi valori molto alti (coda lunga a destra).
-   **Asimmetrica a sinistra** ‚Üí pochi valori molto bassi.
-   **A campana** ‚Üí simile a una distribuzione normale.
-   **Multimodale** ‚Üí pi√π picchi = possibili gruppi o sottocategorie.

#### ‚úÖ 3. **Identifica la modalit√†**

-   La **barra pi√π alta** mostra l‚Äôintervallo **pi√π frequente**.
-   Ti d√† un‚Äôindicazione della **tendenza centrale**.

#### ‚úÖ 4. **Analizza la dispersione**

-   **Barre distribuite su intervalli ampi** ‚Üí alta variabilit√† nei dati.
-   **Barre concentrate in uno stretto intervallo** ‚Üí bassa variabilit√†.

#### ‚úÖ 5. **Cerca outlier o code**

-   **Barre isolate** ‚Üí possibili **valori anomali (outlier)**.
-   **Code lunghe** ‚Üí valori estremi meno frequenti.

------------------------------------------------------------------------

### üìå Riepilogo ‚Äì Schema utile

| Aspetto | Cosa guardare | Cosa indica |
|------------------------|------------------------|------------------------|
| **Asse X** | Intervalli della variabile | Cosa stai misurando |
| **Asse Y** | Altezza delle barre | Frequenza delle osservazioni |
| **Barra pi√π alta** | Valore/modo pi√π frequente | Tendenza centrale |
| **Forma simmetrica o no** | Asimmetria o code | Squilibri, outlier |
| **Larghezza complessiva** | Base dell‚Äôistogramma | Variazione/dispersione nei dati |
:::

## Boxplot

```{=html}
<style>
.flex-container {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
}

.flex-item {
  flex: 1 1 48%;
  min-width: 300px;
}

.card {
  background-color: #f9f9f9;
  padding: 1rem;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
</style>

<div class="flex-container">
  <div class="flex-item card">
```

```{r}
boxplot(mpg ~ as.factor(cyl), data = mtcars,
        main = "Boxplot MPG per Cilindri",
        xlab = "Numero di cilindri",
        ylab = "MPG",
        col = "lightblue")
```

::: tip
#### üì¶ Come si legge un boxplot? ‚Äì Guida schematica e utile

#### ‚úÖ 1. **Comprendi gli elementi base**

-   **Linea centrale nella scatola**: √® la **mediana** (valore centrale).
-   **Bordi della scatola (box)**: indicano il **1¬∞ quartile (Q1)** e il **3¬∞ quartile (Q3)** ‚Üí contengono il 50% centrale dei dati.
-   **"Whiskers" (linee esterne)**: si estendono fino ai dati **non considerati outlier**, solitamente entro 1.5 √ó IQR.
-   **Punti isolati fuori dai whiskers**: sono **outlier** (valori anomali).

#### ‚úÖ 2. **Valuta la simmetria**

-   Se la mediana √® **centrata nella scatola** e i whisker sono di lunghezza simile ‚Üí distribuzione **simmetrica**.
-   Se la mediana √® **spostata** o un whisker √® molto pi√π lungo ‚Üí **asimmetria**.

#### ‚úÖ 3. **Analizza la dispersione**

-   **Larghezza della scatola (Q3 - Q1)** = **Intervallo Interquartile (IQR)** ‚Üí misura la **variabilit√† centrale** dei dati.
-   **Whisker lunghi** ‚Üí valori pi√π dispersi.
-   **Whisker corti** ‚Üí valori pi√π concentrati.

#### ‚úÖ 4. **Individua gli outlier**

-   Punti fuori dai whiskers ‚Üí **valori estremi**.
-   Importante valutarli nel contesto: errori? valori reali ma rari?

------------------------------------------------------------------------

### üìå Riepilogo ‚Äì Schema utile

| Elemento | Cosa rappresenta | Cosa ci dice |
|------------------------|------------------------|------------------------|
| **Linea centrale** | Mediana | Tendenza centrale |
| **Box (Q1 - Q3)** | Intervallo interquartile (IQR) | Variabilit√† centrale |
| **Whiskers** | Dati non-outlier | Dispersione esterna |
| **Outlier** | Valori fuori da 1.5 √ó IQR | Valori estremi (da approfondire) |
| **Simmetria** | Posizione mediana e lunghezza whiskers | Forma della distribuzione (asimmetrie) |
:::

## Violin Plot

```{=html}
<style>
.flex-container {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
}

.flex-item {
  flex: 1 1 48%;
  min-width: 300px;
}

.card {
  background-color: #f9f9f9;
  padding: 1rem;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
</style>

<div class="flex-container">
  <div class="flex-item card">
```

```{r}
library(ggplot2)
ggplot(mtcars, aes(x = factor(cyl), y = mpg)) +
  geom_violin(fill = "lightblue") +
  geom_boxplot(width = 0.1) +
  labs(title = "Violin Plot: MPG per Cilindri",
       x = "Cilindri", y = "MPG")
```

::: tip
#### üéª Come si legge un violin plot? ‚Äì Guida schematica e utile

#### ‚úÖ 1. **Interpreta le componenti**

-   **Forma a ‚Äúviolino‚Äù**: rappresenta la **distribuzione dei dati** tramite una curva di densit√† speculare.
-   **Larghezza** in ciascun punto verticale: indica **quanto sono frequenti i valori** in quell‚Äôintervallo.
-   **Linea interna o box centrale** (opzionale): include **mediana** e **intervallo interquartile (IQR)**, come in un boxplot.

#### ‚úÖ 2. **Valuta la densit√†**

-   Le **zone pi√π larghe** rappresentano **concentrazioni di dati**.
-   Le **zone pi√π strette** indicano valori meno frequenti.
-   A differenza del boxplot, la distribuzione non √® limitata a una forma rettangolare ‚Üí puoi vedere la **forma reale della distribuzione**.

#### ‚úÖ 3. **Analizza la simmetria**

-   Se le due met√† del violino sono **simmetriche** ‚Üí distribuzione bilanciata.
-   Se una met√† √® pi√π larga o pi√π lunga ‚Üí **asimmetria**.

#### ‚úÖ 4. **Combina con il boxplot interno**

-   Se presente, il **box centrale** fornisce la **mediana** e il **range interquartile**.
-   Aiuta a confrontare **forma e centro della distribuzione** contemporaneamente.

------------------------------------------------------------------------

### üìå Riepilogo ‚Äì Schema utile

| Elemento | Cosa rappresenta | Cosa ci dice |
|------------------------|------------------------|------------------------|
| **Larghezza del violino** | Densit√† di dati in ogni intervallo | Frequenza relativa |
| **Forma complessiva** | Distribuzione | Simmetria, multimodalit√† |
| **Box centrale (se presente)** | Mediana + IQR | Tendenza centrale e variabilit√† |
| **Estremit√† del violino** | Code della distribuzione | Valori estremi (non necessariamente outlier) |
| **Asimmetria visiva** | Differenza tra le due met√† | Squilibri nei dati |
:::

## QQ plot

```{=html}
<style>
.flex-container {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
}

.flex-item {
  flex: 1 1 48%;
  min-width: 300px;
}

.card {
  background-color: #f9f9f9;
  padding: 1rem;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
</style>

<div class="flex-container">
  <div class="flex-item card">
```

```{r}
qqnorm(mtcars$mpg,
       main = "QQ-Plot per MPG")
qqline(mtcars$mpg, col = "red")
```

::: tip
#### üìà Come si legge un Q-Q plot? ‚Äì Guida schematica e utile

#### ‚úÖ 1. **Cos‚Äô√® un Q-Q plot?**

-   Un **Q-Q plot** confronta i **quantili di una variabile osservata** con i **quantili di una distribuzione teorica** (di solito **normale**).
-   Serve per **verificare se i dati seguono una certa distribuzione**.

#### ‚úÖ 2. **Leggi l‚Äôasse X e Y**

-   **Asse X**: quantili attesi (dalla distribuzione teorica).
-   **Asse Y**: quantili osservati (dai tuoi dati).

------------------------------------------------------------------------

#### ‚úÖ 3. **Interpreta l‚Äôallineamento**

-   Se i punti stanno **sulla linea diagonale** (linea di riferimento) ‚Üí i dati **seguono la distribuzione teorica** (es. distribuzione normale).
-   Se i punti **deviano dalla linea** ‚Üí i dati **non seguono la distribuzione attesa**.

------------------------------------------------------------------------

#### ‚úÖ 4. **Analizza le deviazioni**

-   **Deviazione in alto o in basso alle estremit√†** ‚Üí i dati hanno **code pi√π pesanti o leggere** rispetto alla distribuzione teorica.
-   **Curvatura a S o a gomito** ‚Üí indica **asimmetria** o **skewness**:
    -   Curva **a S (convessa-concava)** ‚Üí coda lunga a destra (**asimmetria positiva**).
    -   Curva **a gomito (concava-convessa)** ‚Üí coda lunga a sinistra (**asimmetria negativa**).

------------------------------------------------------------------------

### üìå Riepilogo ‚Äì Schema utile

| Aspetto | Cosa osservare | Cosa indica |
|------------------------|------------------------|------------------------|
| **Allineamento dei punti** | Segue la linea diagonale | I dati seguono la distribuzione teorica |
| **Deviazione alle estremit√†** | Code pi√π o meno pesanti | Differenze nella coda |
| **Curvatura dei punti** | Forma a S o a gomito | Asimmetria (skewness) |
| **Distribuzione di confronto** | Di solito normale (ma pu√≤ variare) | Deve essere nota per interpretare correttamente |
:::

## Scatter-plot

```{=html}
<style>
.flex-container {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
}

.flex-item {
  flex: 1 1 48%;
  min-width: 300px;
}

.card {
  background-color: #f9f9f9;
  padding: 1rem;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
</style>

<div class="flex-container">
  <div class="flex-item card">
```

```{r}
plot(mtcars$hp, mtcars$mpg,
     main = "Scatterplot: MPG vs HP",
     xlab = "Cavalli (HP)",
     ylab = "Consumo (MPG)",
     pch = 19,
     col = "darkgreen")
```

::: tip
#### üîµ Come si legge uno scatterplot? ‚Äì Guida schematica e utile

#### ‚úÖ 1. **Cosa mostra uno scatterplot?**

-   Ogni punto rappresenta **una coppia di valori** per due variabili quantitative (X e Y).
-   Serve a visualizzare **relazioni, tendenze e correlazioni** tra due variabili.

------------------------------------------------------------------------

#### ‚úÖ 2. **Leggi gli assi**

-   **Asse X (orizzontale)**: variabile indipendente (predictor).
-   **Asse Y (verticale)**: variabile dipendente (risposta).

------------------------------------------------------------------------

#### ‚úÖ 3. **Osserva la tendenza generale**

-   **Andamento crescente (‚Üó)**: **correlazione positiva** ‚Üí all‚Äôaumentare di X, aumenta anche Y.
-   **Andamento decrescente (‚Üò)**: **correlazione negativa** ‚Üí all‚Äôaumentare di X, Y diminuisce.
-   **Nessun andamento visibile**: **assenza di correlazione** ‚Üí i dati sono sparsi casualmente.

------------------------------------------------------------------------

#### ‚úÖ 4. **Valuta la forza della relazione**

-   **Punti vicini a una linea ideale** ‚Üí relazione forte.
-   **Punti molto dispersi** ‚Üí relazione debole.
-   La forza pu√≤ essere valutata visivamente o con il coefficiente di correlazione.

------------------------------------------------------------------------

#### ‚úÖ 5. **Cerca pattern o anomalie**

-   **Gruppi separati** ‚Üí possibili sottogruppi (cluster).
-   **Andamenti curvi/non lineari** ‚Üí possibile **relazione non lineare**.
-   **Punti lontani dalla nuvola** ‚Üí **outlier** (valori anomali).

------------------------------------------------------------------------

### üìå Riepilogo ‚Äì Schema utile

| Aspetto | Cosa osservare | Cosa indica |
|------------------------|------------------------|------------------------|
| **Distribuzione dei punti** | Densit√†, forma, direzione | Tipo di relazione (positiva, negativa, nulla) |
| **Linearit√†** | Allineamento lungo una retta | Relazione lineare |
| **Dispersione** | Vicinanza dei punti | Forza della correlazione |
| **Outlier** | Punti isolati | Valori anomali da approfondire |
| **Pattern insoliti** | Curve, gruppi, archi | Relazioni non lineari o sottogruppi |
:::

## Residual plot

```{=html}
<style>
.flex-container {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
}

.flex-item {
  flex: 1 1 48%;
  min-width: 300px;
}

.card {
  background-color: #f9f9f9;
  padding: 1rem;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
</style>

<div class="flex-container">
  <div class="flex-item card">
```

```{r}
model <- lm(mpg ~ hp, data = mtcars)
plot(model$fitted.values, residuals(model),
     main = "Residual Plot",
     xlab = "Fitted Values",
     ylab = "Residui",
     pch = 19,
     col = "purple")
abline(h = 0, col = "red", lty = 2)
```

::: tip
#### ‚ôªÔ∏è Come si legge un residual plot? ‚Äì Guida schematica e utile

#### ‚úÖ 1. **Cos‚Äô√® un residual plot?**

-   Mostra i **residui** (errori) di un modello di regressione ‚Üí la differenza tra i valori osservati e quelli previsti.
-   Asse X: valori **predetti** dal modello.
-   Asse Y: **residui** (valori osservati ‚àí valori predetti).

------------------------------------------------------------------------

#### ‚úÖ 2. **Obiettivo principale**

-   Verificare se i **presupposti della regressione** sono soddisfatti:
    -   Linearit√†
    -   Omoscedasticit√† (varianza costante)
    -   Assenza di pattern sistematici

------------------------------------------------------------------------

#### ‚úÖ 3. **Cosa cercare**

| Pattern | Interpretazione |
|------------------------------------|------------------------------------|
| **Punti distribuiti a caso** | ‚úÖ Il modello √® adeguato (errori casuali, omoscedastici). |
| **Forma a U o curva** | ‚ùå Mancanza di linearit√† ‚Üí forse serve un modello non lineare. |
| **Funnel (apertura/chiusura)** | ‚ùå Eteroschedasticit√† ‚Üí la varianza degli errori cambia. |
| **Punti molto distanti** | ‚ùó Outlier nei residui ‚Üí possibili casi problematici. |

------------------------------------------------------------------------

#### ‚úÖ 4. **Cosa idealmente si vuole vedere**

-   Una **nuvola di punti** distribuita **in modo casuale** attorno alla linea orizzontale **y = 0**.
-   Nessun pattern evidente ‚Üí i residui sono indipendenti e distribuiti normalmente con media zero.

------------------------------------------------------------------------

### üìå Riepilogo ‚Äì Schema utile

| Aspetto | Cosa osservare | Cosa indica |
|------------------------|------------------------|------------------------|
| **Dispersione casuale** | Punti sparsi intorno a y = 0 | Buon modello lineare |
| **Pattern curvo o forma a U** | Trend sistematici nei residui | Relazione non lineare |
| **Funnel (cono aperto/chiuso)** | Varianza non costante | Eteroschedasticit√† |
| **Outlier nei residui** | Punti molto distanti | Osservazioni anomale o influenti |
:::

## Boxplot per residui gruppi

```{=html}
<style>
.flex-container {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
}

.flex-item {
  flex: 1 1 48%;
  min-width: 300px;
}

.card {
  background-color: #f9f9f9;
  padding: 1rem;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
</style>

<div class="flex-container">
  <div class="flex-item card">
```

```{r}
boxplot(residuals(model) ~ mtcars$cyl,
        main = "Boxplot dei Residui per Cilindri",
        xlab = "Cilindri",
        ylab = "Residui",
        col = "lightpink")
```

::: tip
#### üì¶üìä Come si leggono i boxplot dei residui per gruppi? ‚Äì Guida schematica e utile

#### ‚úÖ 1. **Cosa mostrano questi boxplot?**

-   Confrontano la **distribuzione dei residui** tra diversi **gruppi** (es. trattamenti, categorie).
-   Ogni box rappresenta **la variabilit√† degli errori** del modello **all‚Äôinterno di un gruppo**.

------------------------------------------------------------------------

#### ‚úÖ 2. **Obiettivo principale**

-   Valutare se il modello **si comporta in modo coerente tra i gruppi**:
    -   Varianza simile? ‚Üí ok
    -   Mediana dei residui ‚âà 0? ‚Üí ok
    -   Outlier concentrati in certi gruppi? ‚Üí potenziale problema

------------------------------------------------------------------------

#### ‚úÖ 3. **Cosa osservare nei boxplot**

| Osservazione | Interpretazione |
|------------------------------------|------------------------------------|
| ‚úÖ **Box simili in tutti i gruppi** | Residui distribuiti in modo coerente ‚Üí modello stabile |
| ‚úÖ **Mediane vicine a 0** | Il modello **non sovrastima n√© sottostima** i gruppi |
| ‚ùå **Box molto diversi tra gruppi** | **Eteroschedasticit√†** ‚Üí varianza non costante |
| ‚ùå **Mediane lontane da 0** | **Sistematici errori di stima** per alcuni gruppi |
| ‚ùó **Molti outlier in un gruppo** | Dati problematici o mal modellati |

------------------------------------------------------------------------

#### ‚úÖ 4. **Quando √® utile usarli?**

-   Dopo aver adattato un modello lineare con **variabili categoriali**.
-   Per controllare **presupposti di omoscedasticit√†** (es. ANOVA, regressione con fattori).
-   Per rilevare **bias o incoerenze tra gruppi**.

------------------------------------------------------------------------

### üìå Riepilogo ‚Äì Schema utile

| Aspetto | Cosa osservare | Cosa indica |
|------------------------|------------------------|------------------------|
| **Varianza dei box** | Simile tra gruppi | Omogeneit√† delle varianze (buono) |
| **Mediana** | Vicina a 0 in ogni gruppo | Nessun bias sistematico |
| **Outlier** | Concentrati in pochi gruppi | Possibili anomalie |
| **Differenze forti nei box** | Modello si adatta diversamente | Violazione presupposti del modello |
:::

## Diagnostica dei modelli

```{=html}
<style>
.flex-container {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
}

.flex-item {
  flex: 1 1 48%;
  min-width: 300px;
}

.card {
  background-color: #f9f9f9;
  padding: 1rem;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
</style>

<div class="flex-container">
  <div class="flex-item card">
```

```{r, fig.width=12, fig.height=10}
library(performance)
library(see)

model <- lm(mpg ~ hp + wt, data = mtcars)

check_model(model)
```

::: tip
#### üßæ Interpretazione dei grafici diagnostici ‚Äì `check_model()`

#### ‚úÖ 1. **Residuals vs Fitted**

-   **Distribuzione casuale** attorno alla linea orizzontale indica:
    -   Corretta specificazione del modello
    -   Varianza costante (omoschedasticit√†)
-   **Pattern (curve, funnel)** ‚Üí possibile violazione di linearit√† o eteroschedasticit√†.

------------------------------------------------------------------------

#### ‚úÖ 2. **Q-Q Plot dei residui**

-   **Punti allineati alla diagonale** ‚Üí i residui seguono una distribuzione normale.
-   **Deviazioni marcate alle estremit√†** ‚Üí possibili problemi di normalit√† (code pesanti o leggere).

------------------------------------------------------------------------

#### ‚úÖ 3. **Scale-Location (Spread vs Fitted)**

-   Verifica la **costanza della varianza dei residui**.
-   **Dispersione uniforme** ‚Üí ok.
-   **Funnel o variazioni di ampiezza** ‚Üí eteroschedasticit√†.

------------------------------------------------------------------------

#### ‚úÖ 4. **Residuals vs Leverage**

-   Identifica **osservazioni influenti**.
-   Punti con **alto leverage e residui grandi** ‚Üí potrebbero avere **impatto eccessivo** sul modello.
-   Da esaminare singolarmente (possibili outlier o errori).
:::

## Predicted vs Actual

```{=html}
<style>
.flex-container {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
}

.flex-item {
  flex: 1 1 48%;
  min-width: 300px;
}

.card {
  background-color: #f9f9f9;
  padding: 1rem;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
</style>

<div class="flex-container">
  <div class="flex-item card">
```

```{r}
plot(mtcars$mpg, model$fitted.values,
     main = "Predicted vs Actual",
     xlab = "Valori Osservati (MPG)",
     ylab = "Valori Predetti",
     pch = 19,
     col = "blue")
abline(a = 0, b = 1, col = "red", lty = 2)
```

::: tip
#### üîÆ Interpretazione del grafico Predicted vs Actual

#### ‚úÖ 1. **Cosa mostra questo grafico?**

-   Confronta i **valori previsti dal modello** (asse X) con i **valori osservati reali** (asse Y).
-   Utile per valutare **l‚Äôaccuratezza del modello**: quanto bene le previsioni replicano i dati osservati?

------------------------------------------------------------------------

#### ‚úÖ 2. **Interpretazione ideale**

-   I punti **dovrebbero allinearsi lungo la diagonale** (linea y = x).
-   Una buona aderenza alla diagonale indica:
    -   Previsioni accurate
    -   Buona capacit√† del modello di rappresentare i dati reali

------------------------------------------------------------------------

#### ‚úÖ 3. **Segnali da osservare**

| Comportamento dei punti | Cosa indica |
|------------------------------------|------------------------------------|
| ‚úÖ Allineamento lungo la diagonale | Previsioni vicine ai valori reali (ottimo) |
| ‚ùå Deviazione sistematica | Bias del modello (sottostima o sovrastima) |
| ‚ùå Dispersione elevata | Previsioni poco precise |
| ‚ùå Pattern curvi o gruppi | Modello mal specificato o relazioni non lineari |

------------------------------------------------------------------------

#### ‚úÖ 4. **Quando usarlo?**

-   In ogni modello di regressione o predizione (lineare, logistico, machine learning).
-   Per valutare la **qualit√† globale delle previsioni**.
:::

## Curva di potenza

```{=html}
<style>
.flex-container {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  margin-left: -2rem;
  margin-right: -2rem;
}

.flex-item {
  flex: 1 1 48%;
  min-width: 300px;
}

.card {
  background-color: #f9f9f9;
  padding: 1rem;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
</style>

<div class="flex-container">
  <div class="flex-item card">
```

```{r}


library(ggplot2)

# Parametri fissi
n1 <- 30
n2 <- 30
alpha <- 0.05
df <- n1 + n2 - 2
cohens_d <- seq(0, 1.5, length.out = 300)

# Funzione per calcolare la potenza
calc_power <- function(d) {
  ncp <- d * sqrt(n1 * n2 / (n1 + n2))  # parametro non centrale
  crit <- qt(1 - alpha, df)             # soglia critica (test unilaterale)
  1 - pt(crit, df, ncp)                 # potenza = 1 - P non rilevata
}

# Applica la funzione a tutta la sequenza di d
power_vals <- sapply(cohens_d, calc_power)

# Crea un data frame
df_power <- data.frame(
  d = cohens_d,
  power = power_vals
)

# Plot con ggplot2
ggplot(df_power, aes(x = d, y = power)) +
  geom_line(color = "blue", size = 1) +
  geom_hline(yintercept = 0.8, linetype = "dotted", color = "darkgreen") +
  geom_vline(xintercept = 0.5, linetype = "dashed", color = "red") +
  labs(
    title = "Curva di potenza tipica (t-test a due campioni, unilaterale)",
    x = "Cohen's d (dimensione dell'effetto)",
    y = "Potenza (1 - Œ≤)"
  ) +
  theme_minimal()
```

::: tip
#### ‚ö° Interpretazione della Curva di Potenza (Power Curve)

#### ‚úÖ 1. **Cos‚Äô√® la curva di potenza?**

-   Mostra come **la probabilit√† di rilevare un effetto reale** (potenza statistica) varia al cambiare della dimensione dell‚Äôeffetto o del numero di osservazioni.
-   Asse X: **Dimensione dell‚Äôeffetto** o **dimensione del campione (n)**
-   Asse Y: **Potenza statistica** (P = 1 - Œ≤), cio√® la probabilit√† di **rifiutare correttamente H‚ÇÄ**.

------------------------------------------------------------------------

#### ‚úÖ 2. **Interpretazione dei valori**

-   Una potenza ‚â• **0.80** (80%) √® **considerata adeguata** ‚Üí bassa probabilit√† di errore di tipo II.
-   Valori pi√π bassi indicano **scarsa sensibilit√† del test** ‚Üí alto rischio di non rilevare un effetto reale.
-   La curva mostra **quanta potenza si guadagna** aumentando il campione o l‚Äôeffetto.

------------------------------------------------------------------------

#### ‚úÖ 3. **Cosa osservare nella curva**

| Forma della curva | Interpretazione |
|------------------------------------|------------------------------------|
| üìà Curva crescente e appiattita | All‚Äôaumentare di n, la potenza si stabilizza |
| üéØ Punto in cui P ‚âà 0.80 | Soglia ottimale per scegliere la dimensione campione |
| ‚ùó Curva piatta a valori bassi | Effetto troppo piccolo per essere rilevabile |

------------------------------------------------------------------------

#### ‚úÖ 4. **Quando usarla?**

-   In fase di **pianificazione dello studio** ‚Üí per determinare **quanti soggetti servono**.
-   Per verificare se un test ha **potenza sufficiente** a rilevare un effetto atteso.

------------------------------------------------------------------------

### üìå Obiettivo finale

-   **Assicurarsi che il test abbia un‚Äôalta probabilit√† di successo**, evitando sprechi di risorse o conclusioni false negative.
:::
